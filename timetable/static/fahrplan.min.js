function incrementBy(a,b){if("hour"==a)hourInput.value=zeroPad(Math.min(Math.max(0,parseInt(hourInput.value)+b),23));else if("minute"==a)minuteInput.value=zeroPad(Math.max(parseInt(parseInt(minuteInput.value)/10)+b,0)%6*10);else if("date"==a){var c=new Date(0);c.setMilliseconds(realDate.setDate(realDate.getDate()+b)),dateInput.value=formatDate(c),realDate=c}}function switch_locations(){var a=document.getElementById("from"),b=document.getElementById("to"),c=a.value;a.value=b.value,b.value=c}function formatTime(a){var b=new Date(0);b.setSeconds(a/1e3);var c=b.getHours(),d=b.getMinutes();return d=d<10?"0"+d:d,c+":"+d}function formatDuration(a){return new Date(a).toISOString().substr(11,5)}function formatDate(a){return zeroPad(a.getDate())+"."+zeroPad(a.getMonth()+1)+"."+a.getFullYear()}function zeroPad(a){return a<10?"0"+a:a}function formatPlatform(a){return a?"Gl. "+a:""}function toggleConnectionDetails(a){var b=document.getElementById("con_details_"+a);b.style.display="none"==b.style.display?"":"none";var c=document.getElementById("show_detail_button_"+a);c.innerHTML="+"==c.innerHTML?"-":"+"}function initTimeSelect(){var a=new Date;dateInput=document.getElementById("date"),hourInput=document.getElementById("hour"),minuteInput=document.getElementById("minute"),dateInput.value=formatDate(a),realDate=a,hourInput.value=zeroPad(a.getHours()),minuteInput.value=zeroPad(a.getMinutes())}function getMidnightTime(a){var b=a.getTime();return b-b%864e5}function addTitleRow(a,b){var c=a.insertRow(-1),d=c.insertCell(0);c.className="title_row",d.colSpan=3,d.innerHTML='<p class="connection_title">'+b+"</p>"}function addContentRow(a,b,c){var d=a.insertRow(-1),e=d.insertCell(0),f=d.insertCell(1),g=d.insertCell(2);e.innerHTML='<p class="time">'+formatTime(b.realDepartureTime)+"</p><p>"+formatPlatform(b.platform)+"</p>",f.innerHTML='<p class="time">'+formatDuration(b.duration)+"</p><p>Umst.: "+b.transfers+"</p>",g.innerHTML='<p class="time">'+formatTime(b.realArrivalTime)+'</p><p><button id="show_detail_button_'+c+'" class="show_details" onclick="toggleConnectionDetails('+c+')">+</button></p>';var h=a.insertRow(-1),i=h.insertCell(0);h.className="connection_details_row",i.colSpan=3,i.innerHTML='<div class="connection_details" style="display: none" id="con_details_'+c+'"></div>'}function addConnectionDetail(a,b){var c='<p class="time">'+formatTime(b.from_time)+"</p>";c+='<p class="platform">'+formatPlatform(b.from_platform)+"</p>",c+="<p>"+b.route+"</p>",c+='<p class="italic">'+formatDuration(b.to_time-b.from_time)+"</p>",c+='<p class="time">'+formatTime(b.to_time)+"</p>",c+='<p class="platform">'+formatPlatform(b.to_platform)+"</p>",a.innerHTML+='<div class="location">'+b.from+'</div><div class="connection_details_route">'+c+"</div>"}function do_query(){var a=document.getElementById("results");a.innerHTML="";var b=document.getElementById("from").value,c=document.getElementById("to").value,d=getMidnightTime(realDate)+36e5*(parseInt(hourInput.value)-1)+6e4*parseInt(minuteInput.value);if(b.length>1&&c.length>1){var e=document.getElementById("connections");"none"==e.style.display&&(e.style.display="block");var f=new XMLHttpRequest;f.open("GET","connection/"+d+"/"+b+"/"+c,!0),f.onload=function(b){for(var c=JSON.parse(b.target.response),d=0;d<c.length;d++){var e=c[d];addTitleRow(a,e.name),addContentRow(a,e,d);var f=document.getElementById("con_details_"+d);f.innerHTML="";for(var g=0;g<e.sections.length;g++){addConnectionDetail(f,e.sections[g])}f.innerHTML+='<div class="location">'+e.to+"</div>"}},f.send()}}var dateInput,hourInput,minuteInput,realDate;initTimeSelect(),new autoComplete({selector:"#from",minChars:2,source:function(a,b){var c=new XMLHttpRequest;c.open("GET","query/"+a,!0),c.onload=function(a){b(JSON.parse(a.target.response))},c.send()}}),new autoComplete({selector:"#to",minChars:2,source:function(a,b){var c=new XMLHttpRequest;c.open("GET","query/"+a,!0),c.onload=function(a){b(JSON.parse(a.target.response))},c.send()}});